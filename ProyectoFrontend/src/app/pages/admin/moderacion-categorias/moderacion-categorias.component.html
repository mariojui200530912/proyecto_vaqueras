<div class="card border-0 shadow-sm bg-light">
  <div class="card-body">
    <h6 class="fw-bold text-muted mb-3">
      <i class="bi bi-tags-fill"></i> Categorías / Etiquetas
    </h6>

    <div class="d-flex flex-wrap gap-2 mb-3">
      @for (cat of categoriasAsignadas(); track cat.id) {
        <span class="badge rounded-pill bg-primary d-flex align-items-center py-2 px-3">
          {{ cat.nombre }}
          <i class="bi bi-x-lg ms-2 cursor-pointer hover-text-danger" 
             (click)="eliminar(cat.id)" 
             title="Quitar categoría"></i>
        </span>
      } @empty {
        <span class="text-muted small fst-italic">Sin categorías asignadas.</span>
      }
    </div>

    <hr class="text-secondary opacity-25">

    <label class="form-label small fw-bold">Agregar Categoría</label>
    <div class="input-group input-group-sm">
      
      <select class="form-select" [(ngModel)]="idCategoriaSeleccionada" [disabled]="isLoading">
        <option [ngValue]="undefined" disabled selected>Seleccionar...</option>
        
        @for (cat of categoriaService.categorias(); track cat.id) {
          @if (!yaEstaAsignada(cat.id)) {
            <option [ngValue]="cat.id">{{ cat.nombre }}</option>
          }
        }
      </select>

      <button class="btn btn-success" 
              type="button" 
              (click)="agregar()" 
              [disabled]="!idCategoriaSeleccionada || isLoading">
        <i class="bi bi-plus-lg"></i> Agregar
      </button>
    </div>

  </div>
</div>

<style>
  .cursor-pointer { cursor: pointer; }
  .hover-text-danger:hover { color: #ffcccc; transform: scale(1.2); transition: 0.2s; }
</style>